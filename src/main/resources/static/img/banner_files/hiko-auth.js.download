"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,a=e},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}!function(e,t){var n={debug:function(e){},warn:function(e){console.warn(e)},error:function(e){console.error(e)},info:function(e){console.info(e)}};if(null===(e=window.HIKO)||void 0===e||!e.extension){if(window.HIKO=_objectSpread(_objectSpread({},window.HIKO),{},{script:!0}),[].includes(null===(t=window.Shopify)||void 0===t?void 0:t.shop))return J("https://apps.hiko.link/js/beta.js");n.debug("0519-2");var o="hiko_socials",i="visited",a="abw",r="g_id_onload",c="g_id_marketing";if(!(location.protocol.indexOf("http")<0||/^(\/[a-zA-Z]{2,3}(-[a-zA-Z]{2})?)?\/challenge($|\?)/.test(location.pathname))){var d="",s="en",l="";g();var u=!1;document.addEventListener("hiko",(function(e){return n.debug("catch event: ".concat(JSON.stringify(e.detail)))}));var p,m,f=void 0,h=!1,v=(p=location.href,m={},p.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,t,n){return m[t]=n})),m).ha;v&&/^[a-f0-9]{78,}$/.test(v)?M(v).then(H):(document.addEventListener("onetap",(function(e){if(n.debug("catch onetap event: ".concat(JSON.stringify(e.detail))),"display"===e.detail.action){var t,o,i,a=document.getElementById(r),d=function(){if("iframe"===e.detail.type){var t=a.querySelector("iframe");if("0px"===getComputedStyle(t).getPropertyValue("bottom"))return t}var n=document.querySelector("#credential_picker_iframe");if(n)return n}(),s=f.onetap.email_marketing&&null!==(t=f.onetap.statement)&&void 0!==t&&t.enable?null===(o=f.onetap.statement)||void 0===o?void 0:o.content:null===(i=f.onetap.marketing)||void 0===i?void 0:i.content;d?(d.style.bottom="58px",a.insertAdjacentHTML("beforeend","<style> .otc { position: fixed; bottom: 0px; left: 0px; z-index: ".concat(d.style.zIndex,'; width; 100%; height: 60px; padding: 0 8px 0 8px;} .otc > div {background-color: white; border-top: 1px solid #dadce0;}</style>\n                <div id="').concat(c,'" class="otc">').concat(s,"</div>"))):e.detail.width&&a.insertAdjacentHTML("beforeend","<style> .otc { width: ".concat(e.detail.width,'px; padding: 0 8px 0 8px;} .otc > div {background-color: white; border-radius: 8px; box-shadow: 0 0 0 1px #dadce0;}</style>\n                <div id="').concat(c,'" class="otc">').concat(s,"</div>"));var l=a.querySelector("#".concat(c));l&&l.addEventListener("click",(function(e){return e.stopPropagation()}))}else if("hide"===e.detail.action){var u=document.getElementById(c);u&&(u.style.display="none")}})),new Promise((function(e){return y(e)})).then((function(){return new Promise((function(e,t){var i=k(o);if(null!=i&&i.version){if((f=i).locale&&s===f.locale)return e(i);n.debug("reload for locale change")}w("POST","/apps/authapp/load",{}).then((function(t){f=t,n.debug("init config"),S(o,t),e(t)})).catch((function(e){n.error(e.message),t()}))}))})).then((function(e){return f.delay?new Promise((function(t){setTimeout((function(){n.debug("delay ".concat(f.delay)),t(e)}),f.delay)})):Promise.resolve(e)})).then((function(){var e,t,r,c;if(l)return function(){var e,t,n,o=k(a);o&&(w("POST","/apps/authapp/user",{id:o,cid:l}),S(a));if(!(null!==(e=f.avatar)&&void 0!==e&&e.profile||null!==(t=f.avatar)&&void 0!==t&&t.header))return;var i=k("hiko_"+l);void 0!==(null==i?void 0:i.avatar)?N(i):w("POST","/apps/authapp/avatar",{id:l,social:(null===(n=f)||void 0===n?void 0:n.click)||""}).then((function(e){S("hiko_"+l,e),N(e)})).catch((function(){}))}();document.querySelector('div[name="hiko-container"]')||document.querySelector('form[action*="/account"]')?C():S(i,location.pathname),null!==(e=f.onetap)&&void 0!==e&&e.enable&&new Promise((function(e){var t=document.createElement("iframe");t.id="3pc",t.src="https://apps.hiko.link/js/assets/cookie.html",t.style.display="none",t.style.position="fixed",document.body.appendChild(t),window.addEventListener("message",(function o(i){if("3pcSupported"===i.data||"3pcUnsupported"===i.data){var a=!1;"3pcUnsupported"===i.data&&(a=!0,n.info("no 3'rd party cookie")),document.body.removeChild(t),window.removeEventListener("message",o),e(a)}}),!1)})).then(E),function(){try{var e=new MutationObserver((function(e){e.forEach((function(e){"attributes"===e.type&&"lang"===e.attributeName&&(S(o),C()),"childList"===e.type&&e.addedNodes.length>0&&e.addedNodes.forEach((function(e){if(e.nodeType===Node.ELEMENT_NODE&&(e.querySelector('form[action*="/account"]')&&C(),"FORM"===e.nodeName)){var t,o=_createForOfIteratorHelper(e.attributes);try{for(o.s();!(t=o.n()).done;){var i=t.value;"action"===i.name&&(n.debug("add form ".concat(i.value)),i.value.indexOf("/account")>=0&&C())}}catch(e){o.e(e)}finally{o.f()}}}))}))}));e.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),e.observe(document.body,{childList:!0,subtree:!0})}catch(e){n.error(e.message)}}(),w("POST","/apps/authapp/load",{version:(t=k(o)).version,locale:t.locale}).then((function(e){var i;if(e.version&&t.version!==e.version||e.error){n.debug("config version ".concat(t.version," > ").concat(e.version)),S(o,e);var a=document.querySelectorAll('div[name="hiko-container"]');a.length&&(a.forEach((function(e){return e.remove})),f=e,C())}e.webview&&null!==(i=f.webview_hides)&&void 0!==i&&i.length&&document.querySelectorAll('div[name="hiko-container"]').forEach((function(e){f.webview_hides.forEach((function(t){var n=e.querySelector("div[data=".concat(t));n&&n.remove()}))}))})),null!==(r=f.ip)&&void 0!==r&&r.address||null!==(c=f.ip)&&void 0!==c&&c.disable||w("GET","https://api.ipify.org?format=json").then((function(e){null!=e&&e.ip&&(n.debug("ip ".concat(e.ip)),f.ip={address:e.ip},_(o,{ip:_objectSpread({},f.ip)}))})).catch((function(e){return n.debug("popup ip fail ".concat(null==e?void 0:e.message))}))})))}}function g(){var e,t,n;d=null===(e=window.Shopify)||void 0===e?void 0:e.shop,s=(null===(t=window.Shopify)||void 0===t?void 0:t.locale)||"en",l=null===(n=window.__st)||void 0===n?void 0:n.cid}function y(e){var t;if(null!==(t=window.Shopify)&&void 0!==t&&t.shop&&window.__st)return g(),e();setTimeout((function(){return y(e)}),300)}function b(e){var t,n;if(!f.onetap.email_marketing&&null!==(t=f.onetap.marketing)&&void 0!==t&&t.enable?"block":f.onetap.email_marketing&&null!==(n=f.onetap.statement)&&void 0!==n&&n.enable?"statement":null)if(e)h||(h=!0,document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:"iframe",width:e}})));else{var o=document.getElementById(r).querySelector("iframe");"0px"===getComputedStyle(o).getPropertyValue("bottom")&&document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:"iframe"}}))}}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(o,i){var a=new XMLHttpRequest,r=function(e){var t=[];for(var n in e)t.push("".concat(n,"=").concat(encodeURIComponent(""+e[n]||"")));return t.join("&")}(_objectSpread(_objectSpread({},n),{},{href:encodeURIComponent(location.href),locale:s}));if("POST"===e){var c="".concat(location.origin).concat(t);a.open("POST",c,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else a.open("GET","https://apps.hiko.link".concat(t,"?").concat(r)),a.open("GET",t.indexOf("http")<0?"https://apps.hiko.link".concat(t,"?").concat(r):t);a.onload=function(){204===a.status?o({}):200===a.status?o(JSON.parse(a.responseText)):i()},a.send(r)}))}function k(e){var t=sessionStorage.getItem(e);if(t)return JSON.parse(t)}function S(e,t){if(!e&&"string"!=typeof e)return n.error("invalid storage set");if(t)if(t.error){var o=JSON.parse(JSON.stringify(t));delete o.error,sessionStorage.setItem(e,JSON.stringify(o))}else sessionStorage.setItem(e,JSON.stringify(t));else sessionStorage.removeItem(e)}function _(e,t){S(e,_objectSpread(_objectSpread({},k(e)||{}),t))}function E(e){var t,o;if(null!==(t=f.onetap)&&void 0!==t&&t.enable&&!/.*\/account/.test(location.pathname))if(!(/(iPod|iPhone|iPad)/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))||f.onetap.safari)if(function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}("onet"))n.warn("one tap supressed");else{var i=(null===(o=f.onetap.position)||void 0===o?void 0:o.maxWidth)||480;if(!1===f.onetap.mobile&&i>=window.innerWidth)n.debug("mobile disabled for width ".concat(window.innerWidth));else{!0===f.events&&(u=!0);var a=e||f.onetap.custom?T:j;f.onetap.delay?isNaN(f.onetap.delay)||setTimeout((function(){n.debug("delay due "+f.onetap.delay),a(x,e)}),1e3*f.onetap.delay):a(x,e)}}else n.warn("one tap not supported")}function x(e){var t,i=_objectSpread(_objectSpread({},e),{},{href:encodeURIComponent(location.href),locale:s,cip:(null===(t=f.ip)||void 0===t?void 0:t.address)||""}),a=document.getElementById(c);if(a){var r=a.querySelector('input[type="checkbox"]');r&&(i.checked=""+r.checked,n.debug("one tap marketing conent ".concat(r.checked)))}u&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"onetap",social:"google"}})),document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"hide"}})),_(o,{click:"google"}),w("POST","/apps/authapp/onetap",i).then((function(e){e&&(e.token?(U(),q(e)):e.multipass?(U(),A(e)):(U(),P(e)))}))}function A(e){u&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"multipass",email:e.email}})),window.location.replace(e.multipass)}function O(e){n.debug(e),"display"===(null==e?void 0:e.g)&&null!=e&&e.h&&(n.debug("one tap block display"),function(){var e,t,n=document.getElementById(r);if(n){var o=!f.onetap.email_marketing&&null!==(e=f.onetap.marketing)&&void 0!==e&&e.enable?"block":f.onetap.email_marketing&&null!==(t=f.onetap.statement)&&void 0!==t&&t.enable?"statement":null;o&&document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:o}})),new MutationObserver((function(e){e.forEach((function(e){if("attributes"===e.type&&"credential_picker_container"===e.target.id&&!h){h=!0;var t=n.querySelector("iframe");o&&document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:o,width:t.offsetWidth}}))}}))})).observe(n,{subtree:!0,attributes:!0})}}(),w("POST","/apps/authapp/event",{name:"onetappop",path:location.pathname}).catch((function(e){return n.error(e.message)}))),"skipped"===(null==e?void 0:e.g)&&(n.debug("one tap block skipped"),document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"hide"}})))}function T(e,t){var o="onetap".concat((new Date).getTime());if(window[o]=e,t)n.debug("pop block in fedcm"),document.body.insertAdjacentHTML("beforeend",'<div id="'.concat(r,'"\n                        data-client_id="').concat(f.onetap.id,'"\n                        data-callback="').concat(o,'"\n                        data-itp_support="true"\n                        data-use_fedcm_for_prompt="true">\n                </div>'));else{var i,a,c,d=(null===(i=f.onetap.position)||void 0===i?void 0:i.right)||20,s=(null===(a=f.onetap.position)||void 0===a?void 0:a.top)||20,l=(null===(c=f.onetap.position)||void 0===c?void 0:c.zIndex)||999,u="momentCallback".concat((new Date).getTime());window[u]=O,n.debug("pop block location ".concat(d,", ").concat(s,", ").concat(l)),document.body.insertAdjacentHTML("beforeend",'<div id="'.concat(r,'"\n                        data-client_id="').concat(f.onetap.id,'"\n                        data-prompt_parent_id="').concat(r,'"\n                        data-callback="').concat(o,'"\n                        data-itp_support="true"\n                    data-moment_callback="').concat(u,'"\n                    style="position: absolute; right: ').concat(d,"px; top: ").concat(s,"px;  z-index: ").concat(l,';">\n                </div>'))}J("https://accounts.google.com/gsi/client")}function j(e){var t,o,i,a,c="_".concat(Math.round(1e7*Math.random()).toString(36)),d=(null===(t=f.onetap.position)||void 0===t?void 0:t.right)||20,s=(null===(o=f.onetap.position)||void 0===o?void 0:o.top)||20,l=(null===(i=f.onetap.position)||void 0===i?void 0:i.zIndex)||999;n.debug("popping one tap frame ".concat(c,", ").concat(d,", ").concat(s,", ").concat(l));var u=document.createElement("style");u.innerHTML="\n              .".concat(c,"cz {position: fixed !important;  right: ").concat(d,"px; top: ").concat(s,"px;  z-index: ").concat(l,";}\n              .").concat(c,"z { border: none;}\n              @media screen and (max-width: ").concat((null===(a=f.onetap.position)||void 0===a?void 0:a.maxWidth)||480,"px) { .").concat(c,"z { position: fixed; bottom: 0px; left: 0px; z-index: 2147483647; width: 100%; height: 239px; border: none; } }\n            ");var p=D('<div id="'.concat(r,'" style="display: none;" class="').concat(c,'cz"/>')),m=D('<iframe class="'.concat(c,'z" src="https://apps.hiko.link/js/assets/tap.html?v=').concat((new Date).getTime(),"&client=").concat(f.onetap.id,'"></iframe>'));p.append(m),document.body.append(u),document.body.append(p),b(),window.addEventListener("message",(function(t){if("size"===t.data.type)m.style.width=t.data.width+"px",m.style.height=t.data.height+"px",n.debug("one tap popup with (".concat(t.data.width,", ").concat(t.data.height,")")),b(t.data.width);else if("notification"===t.data.type){n.debug(t);var o=t.data.notification.g,i=t.data.notification.h;n.debug("".concat(o," one tap, ").concat(JSON.stringify(t.data.notification))),"display"===o?!0===i?(p.style.display="block",w("POST","/apps/authapp/event",{name:"onetappop",path:location.pathname}).catch((function(e){return n.error(e.message)})),document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"popup",social:"google"}}))):!1===i&&(n.debug("display false"),p.remove()):"skipped"==o&&(p.style.display="none",function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="; expires="+o.toGMTString();document.cookie=e+"="+t+i+"; path=/"}("onet",t.data.notification.m),n.debug("user_cancel one tap"),document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"hide"}})))}else"credential"===t.data.type&&e(t.data.token)}))}function P(e){u&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"login",email:e.email,customer_id:e.id}})),z(e.contextpath,{form_type:"customer_login","customer[email]":{value:e.email,style:"border: none; height: 1px; width: 1px;"},"customer[password]":e.password},{display:"block"})}function q(e){u&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"activate",customer_id:e.id}})),z(e.contextpath,{"customer[password]":e.password,"customer[password_confirmation]":e.password,token:e.token,utf8:"✓",id:e.id})}function z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{display:"none"},o=D('<form method="post" action="'.concat(e,'" style="display: ').concat(n.display,';"/>'));for(var i in"none"!==n.display&&o.insertAdjacentHTML("beforeend",'<div name="hiko-container" ignore></div>'),document.body.prepend(o),t){var a=document.createElement("input");a.setAttribute("name",i),o.appendChild(a),"object"===_typeof(t[i])?(a.setAttribute("value",t[i].value),t[i].style&&(a.setAttribute("style",t[i].style),a.focus())):(a.setAttribute("value",t[i]),a.setAttribute("hidden",!0))}"customer_login"===t.form_type?setTimeout((function(){return o.submit()}),3e3):o.submit()}function C(){var e=function(){var e=document.querySelectorAll('div[name="hiko-container"]');if(e.length){var t,o=[],i=!1,a=_createForOfIteratorHelper(e);try{var r=function(){var e=t.value;""===e.getAttribute("ignore")?(i=!0,n.debug("ignore container"),e.querySelectorAll("div[data]").forEach((function(t){return t.onclick=function(){return L({button:t,container:e})}})),document.head.insertAdjacentHTML("beforeend",'<style id="hikoimages">'.concat(f.images,"</style>"))):o.push(e)};for(a.s();!(t=a.n()).done;)r()}catch(e){a.e(e)}finally{a.f()}return i?[]:o}if(/^(\/[a-zA-Z]{2,3}(-[a-zA-Z]{2})?)?\/cart($|\?)/.test(location.pathname))return[];var c=document.querySelectorAll('form[action*="/account"]'),d=[];return c.forEach((function(e){var t;if(!(e.querySelector('div[name="hiko-container"]')||(null===(t=e.action)||void 0===t?void 0:t.indexOf("/account/recover"))>=0))if(null!==e.querySelector("input[type=email]"))if(e.querySelector('input[name="checkout_url"]')&&e.querySelector('input[name="guest"]'))n.debug("gest form, skip container");else{var o=e.action.indexOf("/account/login")>=0?D('<div name="hiko-container" type="login" app/>'):D('<div name="hiko-container" type="register" app/>');"top"===f.position?e.prepend(o):e.append(o),d.push(o)}else n.debug("no input email, skip container")})),d}();!0===f.events&&(u=!0),(null==e?void 0:e.length)>0&&(!function(e){if(document.querySelectorAll('link[href^="'.concat(e,'"]')).length>0)return n.debug("".concat(e," already load")),Promise.resolve();new Promise((function(t){var o=D('<link rel="stylesheet" href="'.concat(e,"?t=").concat((new Date).getTime(),'" >'));o.onload=function(){n.debug("".concat(e," loaded")),t()},document.head.append(o)}))}("https://apps.hiko.link/js/assets/style.css"),document.querySelectorAll("#hikostyles").forEach((function(e){return e.remove()})),document.querySelectorAll("#hikoimages").forEach((function(e){return e.remove()})),document.head.insertAdjacentHTML("beforeend",'<style id="hikostyles">'.concat(f.css,"</style>")),document.head.insertAdjacentHTML("beforeend",'<style id="hikoimages">'.concat(f.images,"</style>")),e.forEach((function(e){e.innerHTML="";var t=e.getAttribute("type")||"login",n=f.html[t];e.insertAdjacentHTML("afterbegin",n),function(e){var t=e.querySelector(".".concat(f.classes.consent)),n=e.querySelectorAll(".".concat(f.classes.buttons," > div"));n.forEach((function(n){return n.onclick=function(){return L({button:n,consent:t,classes:f.classes,marketing:f.marketing,marketing_option:f.marketing_option,container:e})}}))}(e)}))),function(){var e,t=f,n=t.marketing,o=t.marketing_option,i=t.ip,r=_createForOfIteratorHelper(document.querySelectorAll('form[action*="/account"]'));try{var c=function(){var t=e.value;t.addEventListener("submit",(function(){var e,r,c=null===(e=t.querySelector('input[name="customer[password]"]'))||void 0===e?void 0:e.value,d=null===(r=t.querySelector('input[name="customer[email]"]'))||void 0===r?void 0:r.value,s=encodeURIComponent(Math.random().toString(36).substring(5)),l={id:s,email:d};if(null!=i&&i.address&&(l.cip=i.address),"always"===o)l.mkt="true";else if(n){var u=document.querySelector('input[name="'.concat(n,'"][type="checkbox"]'));u&&(l.mkt=u.checked)}if(d&&c&&s)return S(a,s),w("POST","/apps/authapp/user",l)}))};for(r.s();!(e=r.n()).done;)c()}catch(e){r.e(e)}finally{r.f()}}()}function L(e){var t,a,r,c=e.button,l=e.consent,p=e.classes,m=e.marketing,h=e.marketing_option,v=e.container,g=c.getAttribute("data");if(n.debug("".concat(g," clicked")),u&&document.dispatchEvent(new CustomEvent("hiko",{detail:{social:g,action:"click"}})),l){var y=l.querySelector("input");if(y){if(!1===y.checked)return l.setAttribute("class",p.consent+" "+p.disagree);l.setAttribute("class",p.consent)}}var b={google:{width:450,height:680},facebook:{width:520,height:600},spotify:{width:520,height:470},twitter:{width:700,height:800},linkedin:{width:480,height:580},amazon:{width:420,height:630},line:{width:400,height:730},snapchat:{width:400,height:730},kakao:{width:400,height:680},tumblr:{width:430,height:760},twitch:{width:400,height:370},discord:{width:500,height:730},reddit:{width:860,height:620},vk:{width:680,height:450},tiktok:{width:400,height:620}},w=(null===(t=b[g])||void 0===t?void 0:t.width)||400,E=(null===(a=b[g])||void 0===a?void 0:a.height)||580;_(o,{click:g});var x=function(){if("always"===h)return"true";if(m){var e=document.querySelector('input[name="'.concat(m,'"][type="checkbox"]'));if(e)return e.checked}return""}(),A=encodeURIComponent(location.href),O=(new Date).getTime(),T=(null==v?void 0:v.getAttribute("register_tag"))||"",j=(null===(r=f.ip)||void 0===r?void 0:r.address)||"",P=encodeURIComponent(k(i)||"");S(i,"");try{window.addEventListener("message",I,!1),window.open("https://apps.hiko.link/js/login.html?social=".concat(g,"&shop=").concat(d,"&href=").concat(A,"&locale=").concat(s,"&mkt=").concat(x,"&register_tag=").concat(T,"&cip=").concat(j,"&visited=").concat(P,"&ts=").concat(O),"Login social","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=".concat(w,", height=").concat(E)).focus()}catch(e){n.debug("redirecting ..."),z("https://apps.hiko.link/admin/auth",{social:g,shop:d,href:A,locale:s})}}function I(e){n.debug("received from popup ".concat(e.origin)),e.data.en&&M(e.data.en).then(H)}function M(e){var t=new TextEncoder("hex"),n=new TextDecoder("utf8");return crypto.subtle.importKey("raw",t.encode(d.substring(0,16)),"AES-GCM",!0,["decrypt"]).then((function(n){return crypto.subtle.decrypt({name:"AES-GCM",iv:t.encode(d.replace(".","").substring(0,16))},n,new Uint8Array(e.match(/../g).map((function(e){return parseInt(e,16)}))).buffer)})).then((function(e){return JSON.parse(n.decode(e))}))}function H(e){"login"===e.name?(U(),P(e.data)):"multipass"===e.name?(U(),A(e.data)):"activate"===e.name?(U(),q(e.data)):"error"===e.name&&function(e){var t=e.code,n=e.type,o=e.email,i=e.message;u&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"error",message:i}}));if(o&&541===t){var a=document.querySelectorAll('input[name="customer[email]"]');a.length&&a.forEach((function(e){return e.value=o}))}document.querySelectorAll('div[name="hiko-err"]').forEach((function(e){e.innerHTML="";var t=document.createElement("div");e.append(t),"error"===n?(t.setAttribute("class","form-message form-message--error errors"),t.insertAdjacentHTML("beforeend",'<i class="fas fa-exclamation-circle"/>')):"warning"===n?(t.setAttribute("class","form-message form-message--success"),t.insertAdjacentHTML("beforeend",'<i class="fas fa-exclamation"/>')):(t.setAttribute("form-message form-message--success"),t.insertAdjacentHTML("beforeend",'<i class="fas fa-check-circle"/>')),t.append(document.createTextNode(" "+i))}))}(e.data)}function N(e){if(null!=e&&e.avatar){var t=function(e){var t=e.first_name,n=e.last_name;if(!t&&!n)return"";if(t&&n)return"".concat(t," ").concat(n);if(t)return t;if(n)return n}(e),n=document.querySelectorAll('[name="hiko-avatar"]');if(n.length)n.forEach((function(n){if(e.avatar){if("IMG"===n.tagName)n.setAttribute("src",e.avatar),n.setAttribute("title",t);else if("A"===n.tagName){var o=n.querySelector("img");o?(o.setAttribute("src",e.avatar),o.setAttribute("title",t)):n.insertAdjacentHTML("beforeend",'<img src="'.concat(e.avatar,'" title="').concat(t,'"/>'))}n.style.dispay="block"}}));else if(/^(\/[a-zA-Z]{2,3}(-[a-zA-Z]{2})?)?\/account($|\?)/.test(location.pathname)){var o;if(null===(o=f.avatar)||void 0===o||!o.profile)return;var i=document.querySelector("a[href*='/account/addresses']");if(i){var a,r,c='<img src="'.concat(e.avatar,'" title="').concat(t,'" alt="').concat(t,'" style="border-radius: 20%;width: 64px;height: 64px;margin-top: 10px"/>');null!==(a=f.avatar)&&void 0!==a&&a.profile_link&&(c='<a href="'.concat(null===(r=f.avatar)||void 0===r?void 0:r.profile_link,'">').concat(c,"</a>"));var d=D(c);i.parentNode.after(d),d.after(D("<p><bold>".concat(t,"</bold></p>")))}}else{var s;if(null===(s=f.avatar)||void 0===s||!s.header)return;var l=document.querySelectorAll("a[href*='/account']");if(l.length){var u,p,m='<img src="'.concat(e.avatar,'" class="icon" title="').concat(t,'" alt="').concat(t,'" style="border-radius: 20%;width: 24px;height: 24px"/>');null!==(u=f.avatar)&&void 0!==u&&u.header_link&&(m='<a href="'.concat(null===(p=f.avatar)||void 0===p?void 0:p.header_link,'">').concat(m,"</a>"));var h=D(m);l.forEach((function(e){if(e.href&&e.href.match(/.*\/account$/)&&e.closest("header")){var t=e.cloneNode();t.append(h),e.after(t)}}))}}}}function D(e){var t=document.createElement("div");return t.innerHTML=e,1!==t.childElementCount&&n.error("childrens "+t.childElementCount+", "+e),t.firstChild}function J(e){var t=e.indexOf("http")>=0?e:"https://apps.hiko.link".concat(e);return document.querySelectorAll('script[src^="'.concat(t,'"]')).length>0?Promise.resolve():new Promise((function(o){var i=document.createElement("script");i.src=t,i.defer="defer",i.async="async",i.onload=function(){n.debug("".concat(e," loaded")),o()},document.head.appendChild(i)}))}function U(){document.body.insertAdjacentHTML("beforeend",'<style>\n            .hikoloading {\n              position: absolute;\n              top: 0;\n              left: 0;\n              z-index: 100;\n              width: 100vw;\n              height: 400vh;\n              background-color: rgba(192, 192, 192, 0.5);\n              background-repeat: no-repeat;\n              background-position: center;\n            }\n            .hikospinner {\n              position: fixed;\n              top: 50%;\n              left: 50%;\n              margin: auto;\n              width: 50px;\n              height: 50px;\n              -webkit-animation-name: hikospin;\n              -webkit-animation-duration: 2000ms;\n              -webkit-animation-iteration-count: infinite;\n              -webkit-animation-timing-function: linear;\n              -moz-animation-name: hikospin;\n              -moz-animation-duration: 2000ms;\n              -moz-animation-iteration-count: infinite;\n              -moz-animation-timing-function: linear;\n              -ms-animation-name: hikospin;\n              -ms-animation-duration: 2000ms;\n              -ms-animation-iteration-count: infinite;\n              -ms-animation-timing-function: linear;\n              animation-name: hikospin;\n              animation-duration: 2000ms;\n              animation-iteration-count: infinite;\n              animation-timing-function: linear;\n            }\n          \n            @-ms-keyframes hikospin {\n              from {\n                -ms-transform: rotate(0deg);\n              }\n              to {\n                -ms-transform: rotate(360deg);\n              }\n            }\n          \n            @-moz-keyframes hikospin {\n              from {\n                -moz-transform: rotate(0deg);\n              }\n              to {\n                -moz-transform: rotate(360deg);\n              }\n            }\n          \n            @-webkit-keyframes hikospin {\n              from {\n                -webkit-transform: rotate(0deg);\n              }\n              to {\n                -webkit-transform: rotate(360deg);\n              }\n            }\n          \n            @keyframes hikospin {\n              from {\n                transform: rotate(0deg);\n              }\n              to {\n                transform: rotate(360deg);\n              }\n            }\n          </style>\n          \n          <div class="hikoloading">\n            <div class="hikospinner">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4335 4335" width="50" height="50">\n                <path\n                  fill="black"\n                  d="M3346 1077c41,0 75,34 75,75 0,41 -34,75 -75,75 -41,0 -75,-34 -75,-75 0,-41 34,-75 75,-75zm-1198 -824c193,0 349,156 349,349 0,193 -156,349 -349,349 -193,0 -349,-156 -349,-349 0,-193 156,-349 349,-349zm-1116 546c151,0 274,123 274,274 0,151 -123,274 -274,274 -151,0 -274,-123 -274,-274 0,-151 123,-274 274,-274zm-500 1189c134,0 243,109 243,243 0,134 -109,243 -243,243 -134,0 -243,-109 -243,-243 0,-134 109,-243 243,-243zm500 1223c121,0 218,98 218,218 0,121 -98,218 -218,218 -121,0 -218,-98 -218,-218 0,-121 98,-218 218,-218zm1116 434c110,0 200,89 200,200 0,110 -89,200 -200,200 -110,0 -200,-89 -200,-200 0,-110 89,-200 200,-200zm1145 -434c81,0 147,66 147,147 0,81 -66,147 -147,147 -81,0 -147,-66 -147,-147 0,-81 66,-147 147,-147zm459 -1098c65,0 119,53 119,119 0,65 -53,119 -119,119 -65,0 -119,-53 -119,-119 0,-65 53,-119 119,-119z"\n                ></path>\n              </svg>\n            </div>\n          </div>')}}();